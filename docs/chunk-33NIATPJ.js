import{a as N,b as c,c as D,d as A,f as k,g as V,h as O,i as T,j as L,k as q,l as R,m as $,n as G,o as j}from"./chunk-GHGJRAGF.js";import{a as B}from"./chunk-NOIHIEII.js";import{A as m,E as S,F as l,H as b,I,J as u,K as f,L as n,M as i,N as g,P as _,Q as x,U as a,V as F,W as s,Y as h,a as M,b as P,ka as v,o as p,oa as E,qa as w,z as d}from"./chunk-I7QWZ5B3.js";function K(r,t){if(r&1&&(n(0,"div",0),a(1),i()),r&2){let e=t.$implicit;d(),s(" ",e,`
`)}}function Q(r,t){if(r&1&&u(0,K,2,1,"div",0,I),r&2){let e=x();f(e.errorMessages)}}var C=class r{control=null;get errorMessages(){let t=[];if(this.control&&this.control.errors)for(let e in this.control.errors)this.control.errors.hasOwnProperty(e)&&t.push(this.getErrorMessage(e,this.control.errors[e]));return t}getErrorMessage(t,e){return{required:"This field is required.",minlength:`Minimum length is ${e.requiredLength}.`,maxlength:`Maximum length is ${e.requiredLength}.`}[t]||"Invalid field"}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=p({type:r,selectors:[["app-control-validator"]],inputs:{control:"control"},standalone:!0,features:[h],decls:1,vars:1,consts:[[1,"alert","alert-danger","py-2"]],template:function(e,o){e&1&&S(0,Q,2,0),e&2&&b(o.control!=null&&o.control.invalid&&(o.control!=null&&o.control.dirty||o.control!=null&&o.control.touched)?0:-1)},dependencies:[v],styles:[".alert[_ngcontent-%COMP%]{color:#d9534f;font-size:.9rem;margin-top:5px}"]})};var U=(r,t)=>t.id;function W(r,t){if(r&1&&(n(0,"option",15),a(1),i()),r&2){let e=t.$implicit;l("value",e.id),d(),F(e.name)}}var y=class r{constructor(t,e,o,z){this.fb=t;this.productManagementService=e;this.router=o;this.route=z}categoriesList=[];form;formMode=1;productId;currentProductData;ngOnInit(){this.initForm(),this.getLookup(),this.checkMode()}initForm(){this.form=this.fb.group({name:["",[c.required,c.maxLength(30)]],price:["",[c.required,c.min(1)]],categoryId:[null,[c.required]]})}ngAfterViewChecked(){console.log("ProductFormComponent View Checked")}getLookup(){this.productManagementService.getCategories().subscribe({next:t=>{this.categoriesList=t}})}checkMode(){this.route.params.subscribe(t=>{t.id?(this.productId=t.id,this.formMode=2,this.populateFormFields()):this.formMode=1})}populateFormFields(){this.productId&&this.productManagementService.getProductById(this.productId).subscribe({next:t=>{t&&(this.currentProductData=t,this.form.patchValue(t))}})}onAddNewProduct(){if(this.form.markAllAsTouched(),this.form.invalid)return;(this.isEditMode?this.productManagementService.updateProduct(this.prepareDateForSending(),this.productId):this.productManagementService.addNewProduct(this.prepareDateForSending())).subscribe({next:e=>{e&&(this.router.navigate(["/"]),this.form.reset(),this.productManagementService.resetFilter())}})}prepareDateForSending(){return P(M({},this.form.value),{id:this.isEditMode?this.productId:Math.random().toString(36).substr(2,9)+Date.now().toString(36),category:this.categoriesList.find(e=>e.id==this.form.get("categoryId")?.value)?.name,creationDate:new Date().toISOString().split("T")[0]})}get isEditMode(){return this.formMode===2}static \u0275fac=function(e){return new(e||r)(m($),m(B),m(w),m(E))};static \u0275cmp=p({type:r,selectors:[["app-product-form"]],standalone:!0,features:[h],decls:34,vars:7,consts:[[1,"form-wrapper","container","my-3"],[1,"my-2"],[1,"text-primary"],[1,"form-content","w-50","m-auto"],[1,"row","g-3","mt-5",3,"formGroup"],[1,"col-12"],["for","product_name",1,"form-label"],[1,"text-danger"],["type","text","id","product_name","formControlName","name","placeholder","Enter Product Name",1,"form-control"],[3,"control"],["for","product_price",1,"form-label"],["type","number","id","product_price","formControlName","price","placeholder","Enter Product Price",1,"form-control"],["for","product_Category",1,"form-label"],["id","product_Category","formControlName","categoryId","aria-label","Default select example",1,"form-select"],["selected","","disabled","",3,"value"],[3,"value"],[1,"col-12","d-flex","align-items-center","justify-content-end"],[1,"btn","btn-primary",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"header",1)(2,"h4",2),a(3),i()(),n(4,"div",3)(5,"form",4)(6,"div",5)(7,"label",6),a(8,"Product Name "),n(9,"span",7),a(10," *"),i()(),g(11,"input",8)(12,"app-control-validator",9),i(),n(13,"div",5)(14,"label",10),a(15,"Product Price "),n(16,"span",7),a(17," *"),i()(),g(18,"input",11)(19,"app-control-validator",9),i(),n(20,"div",5)(21,"label",12),a(22,"Product Category "),n(23,"span",7),a(24," *"),i()(),n(25,"select",13)(26,"option",14),a(27," Open this select menu "),i(),u(28,W,2,2,"option",15,U),i(),g(30,"app-control-validator",9),i(),n(31,"div",16)(32,"button",17),_("click",function(){return o.onAddNewProduct()}),a(33),i()()()()()),e&2&&(d(3),s(" ",o.isEditMode?"Edit product Date":"Add New product"," "),d(2),l("formGroup",o.form),d(7),l("control",o.form.get("name")),d(7),l("control",o.form.get("price")),d(7),l("value",null),d(2),f(o.categoriesList),d(2),l("control",o.form.get("categoryId")),d(3),s(" ",o.isEditMode?"Edit":"Add"," "))},dependencies:[v,G,k,q,R,N,V,L,D,A,j,O,T,C],styles:[".form-wrapper[_ngcontent-%COMP%]{box-shadow:#959da533 0 8px 24px;padding:20px;width:90%}@media (max-width: 992px){.form-wrapper[_ngcontent-%COMP%]   .form-content[_ngcontent-%COMP%]{width:100%!important}}"]})};export{y as default};
